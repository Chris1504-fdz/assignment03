2025-12-12 13:38:41,562 | Loading HH-RLHF dataset...
2025-12-12 13:38:42,603 | Using 2000 prompts for GRPO training
2025-12-12 13:38:42,854 | Loading policy model...
2025-12-12 13:38:43,554 | Loading reference model (frozen)...
2025-12-12 13:38:44,090 | Loading reward model (frozen)...
2025-12-12 13:38:45,264 | ===== GRPO (single GPU) | device=cuda:0 =====
2025-12-12 13:38:45,264 | ===== Epoch 1/1 =====
2025-12-12 13:39:17,669 | [Step 20] loss=1.5565 | pg=1.6181 | kl=-0.0615 | mean_reward=-5.4102 | ratio_mean=2.663 std=3.645 clipfrac=0.625
2025-12-12 13:39:50,358 | [Step 40] loss=-0.0455 | pg=0.1155 | kl=-0.1610 | mean_reward=-0.8989 | ratio_mean=0.979 std=0.462 clipfrac=0.500
2025-12-12 13:40:23,374 | [Step 60] loss=-0.3393 | pg=0.1058 | kl=-0.4451 | mean_reward=-1.5635 | ratio_mean=0.831 std=0.873 clipfrac=0.500
2025-12-12 13:40:55,519 | [Step 80] loss=-0.6812 | pg=0.0899 | kl=-0.7711 | mean_reward=-2.6133 | ratio_mean=0.617 std=0.362 clipfrac=0.500
2025-12-12 13:41:29,060 | [Step 100] loss=0.0783 | pg=0.2818 | kl=-0.2035 | mean_reward=-1.5000 | ratio_mean=1.015 std=0.728 clipfrac=0.500
2025-12-12 13:42:02,986 | [Step 120] loss=-0.0745 | pg=0.0018 | kl=-0.0763 | mean_reward=-1.3623 | ratio_mean=0.994 std=0.072 clipfrac=0.000
2025-12-12 13:42:36,100 | [Step 140] loss=0.0027 | pg=-0.0073 | kl=0.0101 | mean_reward=-3.6094 | ratio_mean=0.979 std=0.045 clipfrac=0.000
2025-12-12 13:43:08,878 | [Step 160] loss=0.0086 | pg=0.0022 | kl=0.0064 | mean_reward=0.7231 | ratio_mean=0.988 std=0.036 clipfrac=0.000
2025-12-12 13:43:41,184 | [Step 180] loss=-0.0114 | pg=-0.0095 | kl=-0.0018 | mean_reward=-1.2695 | ratio_mean=0.982 std=0.038 clipfrac=0.000
2025-12-12 13:44:13,982 | [Step 200] loss=0.0139 | pg=-0.0016 | kl=0.0155 | mean_reward=-3.2930 | ratio_mean=1.006 std=0.035 clipfrac=0.000
2025-12-12 13:44:46,743 | [Step 220] loss=0.0026 | pg=-0.0000 | kl=0.0026 | mean_reward=-1.7100 | ratio_mean=1.006 std=0.023 clipfrac=0.000
2025-12-12 13:45:20,356 | [Step 240] loss=0.0315 | pg=0.0034 | kl=0.0280 | mean_reward=-1.3662 | ratio_mean=0.990 std=0.031 clipfrac=0.000
2025-12-12 13:45:53,667 | [Step 260] loss=-0.0442 | pg=-0.0188 | kl=-0.0253 | mean_reward=-0.9365 | ratio_mean=1.015 std=0.079 clipfrac=0.000
2025-12-12 13:46:26,447 | [Step 280] loss=-0.0068 | pg=-0.0077 | kl=0.0009 | mean_reward=-3.2031 | ratio_mean=0.975 std=0.066 clipfrac=0.000
2025-12-12 13:47:00,219 | [Step 300] loss=0.0175 | pg=-0.0000 | kl=0.0175 | mean_reward=-2.4844 | ratio_mean=1.000 std=0.000 clipfrac=0.000
2025-12-12 13:47:33,278 | [Step 320] loss=0.0287 | pg=0.0154 | kl=0.0133 | mean_reward=-1.9570 | ratio_mean=1.005 std=0.064 clipfrac=0.000
2025-12-12 13:48:07,478 | [Step 340] loss=0.0285 | pg=0.0666 | kl=-0.0381 | mean_reward=-1.8291 | ratio_mean=0.970 std=0.128 clipfrac=0.125
2025-12-12 13:48:41,496 | [Step 360] loss=0.0104 | pg=-0.0047 | kl=0.0151 | mean_reward=-1.0684 | ratio_mean=0.998 std=0.111 clipfrac=0.250
2025-12-12 13:49:15,568 | [Step 380] loss=-0.4715 | pg=0.0105 | kl=-0.4820 | mean_reward=-2.4062 | ratio_mean=0.972 std=0.296 clipfrac=0.375
2025-12-12 13:49:49,640 | [Step 400] loss=-0.7375 | pg=0.0120 | kl=-0.7495 | mean_reward=-3.1582 | ratio_mean=0.983 std=0.309 clipfrac=0.375
2025-12-12 13:50:23,994 | [Step 420] loss=-0.2458 | pg=0.0341 | kl=-0.2800 | mean_reward=-4.9453 | ratio_mean=0.948 std=0.155 clipfrac=0.125
2025-12-12 13:50:57,311 | [Step 440] loss=-0.1506 | pg=-0.0467 | kl=-0.1040 | mean_reward=0.4524 | ratio_mean=1.000 std=0.113 clipfrac=0.000
2025-12-12 13:51:30,615 | [Step 460] loss=-0.2976 | pg=-0.0090 | kl=-0.2885 | mean_reward=-1.8789 | ratio_mean=0.953 std=0.081 clipfrac=0.000
2025-12-12 13:52:03,695 | [Step 480] loss=-0.0420 | pg=0.0013 | kl=-0.0433 | mean_reward=-1.4590 | ratio_mean=0.973 std=0.046 clipfrac=0.000
2025-12-12 13:52:35,858 | [Step 500] loss=0.0211 | pg=0.0009 | kl=0.0203 | mean_reward=-3.8770 | ratio_mean=0.995 std=0.018 clipfrac=0.000
2025-12-12 13:53:07,852 | [Step 520] loss=-0.0053 | pg=-0.0094 | kl=0.0041 | mean_reward=-2.1016 | ratio_mean=0.986 std=0.030 clipfrac=0.000
2025-12-12 13:53:41,183 | [Step 540] loss=0.0013 | pg=-0.0000 | kl=0.0013 | mean_reward=-3.2656 | ratio_mean=1.009 std=0.018 clipfrac=0.000
2025-12-12 13:54:13,357 | [Step 560] loss=-0.0084 | pg=0.0107 | kl=-0.0191 | mean_reward=-2.0742 | ratio_mean=1.010 std=0.028 clipfrac=0.000
2025-12-12 13:54:46,335 | [Step 580] loss=0.0124 | pg=0.0063 | kl=0.0061 | mean_reward=-5.8867 | ratio_mean=0.997 std=0.026 clipfrac=0.000
2025-12-12 13:55:19,597 | [Step 600] loss=-0.0175 | pg=-0.0120 | kl=-0.0055 | mean_reward=0.9468 | ratio_mean=0.984 std=0.025 clipfrac=0.000
2025-12-12 13:55:52,504 | [Step 620] loss=0.0022 | pg=0.0021 | kl=0.0002 | mean_reward=-2.9648 | ratio_mean=0.993 std=0.010 clipfrac=0.000
2025-12-12 13:56:26,108 | [Step 640] loss=0.0042 | pg=-0.0000 | kl=0.0042 | mean_reward=-3.9805 | ratio_mean=1.004 std=0.020 clipfrac=0.000
2025-12-12 13:56:59,055 | [Step 660] loss=0.0067 | pg=0.0044 | kl=0.0023 | mean_reward=-0.6709 | ratio_mean=1.012 std=0.034 clipfrac=0.000
2025-12-12 13:57:32,242 | [Step 680] loss=-0.0011 | pg=-0.0000 | kl=-0.0011 | mean_reward=-3.4883 | ratio_mean=1.003 std=0.018 clipfrac=0.000
2025-12-12 13:58:05,647 | [Step 700] loss=-0.0022 | pg=-0.0000 | kl=-0.0022 | mean_reward=-0.4604 | ratio_mean=1.011 std=0.043 clipfrac=0.000
2025-12-12 13:58:38,697 | [Step 720] loss=-0.0043 | pg=-0.0000 | kl=-0.0043 | mean_reward=-2.3613 | ratio_mean=0.999 std=0.033 clipfrac=0.000
2025-12-12 13:59:10,256 | [Step 740] loss=0.0036 | pg=-0.0000 | kl=0.0036 | mean_reward=-1.7227 | ratio_mean=0.993 std=0.018 clipfrac=0.000
2025-12-12 13:59:43,677 | [Step 760] loss=0.0055 | pg=-0.0000 | kl=0.0055 | mean_reward=-1.9297 | ratio_mean=1.005 std=0.017 clipfrac=0.000
2025-12-12 14:00:18,325 | [Step 780] loss=0.0023 | pg=-0.0000 | kl=0.0023 | mean_reward=-2.9668 | ratio_mean=0.997 std=0.011 clipfrac=0.000
2025-12-12 14:00:51,674 | [Step 800] loss=0.0085 | pg=-0.0000 | kl=0.0085 | mean_reward=0.0840 | ratio_mean=1.000 std=0.024 clipfrac=0.000
2025-12-12 14:01:25,892 | [Step 820] loss=-0.0079 | pg=-0.0000 | kl=-0.0079 | mean_reward=1.0264 | ratio_mean=1.001 std=0.012 clipfrac=0.000
2025-12-12 14:02:00,122 | [Step 840] loss=-0.0045 | pg=-0.0000 | kl=-0.0045 | mean_reward=-1.5791 | ratio_mean=1.001 std=0.010 clipfrac=0.000
2025-12-12 14:02:33,871 | [Step 860] loss=0.0023 | pg=-0.0000 | kl=0.0023 | mean_reward=-0.7485 | ratio_mean=0.994 std=0.009 clipfrac=0.000
2025-12-12 14:03:07,600 | [Step 880] loss=-0.0008 | pg=-0.0000 | kl=-0.0008 | mean_reward=-2.4355 | ratio_mean=1.006 std=0.016 clipfrac=0.000
2025-12-12 14:03:41,554 | [Step 900] loss=-0.0011 | pg=-0.0000 | kl=-0.0011 | mean_reward=-3.4531 | ratio_mean=0.998 std=0.014 clipfrac=0.000
2025-12-12 14:04:14,644 | [Step 920] loss=-0.0004 | pg=-0.0000 | kl=-0.0004 | mean_reward=-1.5127 | ratio_mean=0.991 std=0.029 clipfrac=0.000
2025-12-12 14:04:47,090 | [Step 940] loss=-0.0036 | pg=-0.0000 | kl=-0.0036 | mean_reward=1.0752 | ratio_mean=0.995 std=0.014 clipfrac=0.000
2025-12-12 14:05:19,341 | [Step 960] loss=-0.0045 | pg=-0.0000 | kl=-0.0045 | mean_reward=-0.9258 | ratio_mean=1.002 std=0.008 clipfrac=0.000
2025-12-12 14:05:52,008 | [Step 980] loss=0.0140 | pg=-0.0000 | kl=0.0140 | mean_reward=-0.9268 | ratio_mean=1.000 std=0.000 clipfrac=0.000
2025-12-12 14:06:24,849 | [Step 1000] loss=-0.0092 | pg=-0.0000 | kl=-0.0092 | mean_reward=-0.1246 | ratio_mean=1.005 std=0.013 clipfrac=0.000
2025-12-12 14:06:26,089 | Saved: models/grpo_policy_epoch1.pt
